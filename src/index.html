<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de Texto Avançado</title>
    <!-- Tailwind CSS CDN para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Biblioteca Lucide Icons para ícones modernos -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-slate-100 dark:bg-slate-900 flex flex-col">

    <div id="main-container" class="w-full h-full flex flex-col bg-white dark:bg-slate-800">

        <!-- Barra de Ferramentas Principal -->
        <div class="toolbar flex flex-wrap items-center justify-between p-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800 gap-2 flex-shrink-0">
             <!-- Grupo de Documentos -->
            <div class="flex items-center gap-2">
                <button id="new-doc-btn" title="Novo Documento (Ctrl+N)" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"><i data-lucide="file-plus-2"></i></button>
                <select id="doc-selector" class="p-2 border border-gray-300 rounded-md bg-white dark:bg-slate-700 dark:border-slate-600 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
                <button id="delete-doc-btn" title="Excluir Documento Atual" class="p-2 rounded-md hover:bg-red-200 dark:hover:bg-red-800 transition-colors text-red-600 dark:text-red-400"><i data-lucide="trash-2"></i></button>
            </div>
            
            <!-- Grupo de Ferramentas de Edição -->
            <div class="flex items-center gap-2">
                 <button id="download-btn" title="Baixar como .txt" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"><i data-lucide="download"></i></button>
                 <button id="find-replace-btn" title="Localizar e Substituir (Ctrl+F)" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"><i data-lucide="search"></i></button>
            </div>

            <!-- Grupo de Configurações e Ajuda -->
            <div class="flex items-center gap-2">
                <div class="ruler-input-group flex items-center gap-2 text-slate-600 dark:text-slate-300">
                    <i data-lucide="ruler" class=""></i>
                    <input type="number" id="ruler-column-input" min="10" max="200" value="80" class="w-16 p-1 border border-gray-300 rounded-md bg-white dark:bg-slate-700 dark:border-slate-600 focus:outline-none focus:ring-1 focus:ring-blue-500">
                </div>
                <button id="toggle-mode-btn" title="Alternar Tema" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"><i data-lucide="moon"></i></button>
                <button id="show-shortcuts-btn" title="Ver Atalhos" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"><i data-lucide="keyboard"></i></button>
            </div>
        </div>

        <!-- Área de Edição de Texto Wrapper -->
        <div id="editor-wrapper" class="relative flex-grow bg-white dark:bg-slate-900">
            <div id="ruler-line"></div>
            <textarea id="editor" class="w-full h-full p-4 text-base focus:outline-none z-10 bg-transparent text-slate-800 dark:text-slate-200 placeholder-slate-400 dark:placeholder-slate-500" placeholder="Carregando..."></textarea>
        </div>

        <!-- Barra de Status -->
        <div class="status-bar flex justify-end items-center p-2 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800 text-sm text-gray-600 dark:text-gray-400 gap-4 flex-shrink-0">
            <span id="save-status"></span>
            <span id="word-count">Palavras: 0</span>
            <span id="char-count">Caracteres: 0</span>
            <span id="user-id-display" class="font-mono text-xs" title="Seu ID de Usuário"></span>
        </div>
    </div>

    <!-- Modais -->
    <div id="shortcuts-modal-overlay" class="modal-overlay fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 opacity-0 invisible">
        <div class="modal-content bg-white dark:bg-slate-800 p-8 rounded-lg shadow-xl max-w-lg w-full relative transform -translate-y-5 text-slate-800 dark:text-slate-200">
            <button id="shortcuts-modal-close-btn" class="modal-close-btn absolute top-3 right-3 p-1 rounded-full text-2xl hover:bg-gray-200 dark:hover:bg-slate-700">&times;</button>
            <h2 class="text-2xl font-bold mb-4">Atalhos de Teclado</h2>
            <div class="space-y-2">
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + S</kbd>: Forçar salvamento do documento.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + F</kbd>: Abrir Localizar e Substituir.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + N</kbd>: Criar novo documento.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + D</kbd>: Selecionar próxima ocorrência.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + Shift + D</kbd>: Duplicar linha atual.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Alt + Shift + ↑/↓</kbd>: Mover linha para cima/baixo.</p>
                <p><kbd class="font-mono bg-gray-200 dark:bg-slate-600 p-1 rounded">Ctrl + U</kbd>: Converter seleção para maiúsculas.</p>
            </div>
        </div>
    </div>

    <div id="find-replace-modal-overlay" class="modal-overlay fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 opacity-0 invisible">
        <div class="modal-content bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl max-w-md w-full relative transform -translate-y-5 text-slate-800 dark:text-slate-200">
            <button id="find-replace-modal-close-btn" class="modal-close-btn absolute top-3 right-3 text-2xl p-1 rounded-full hover:bg-gray-200 dark:hover:bg-slate-700">&times;</button>
            <h2 class="text-xl font-bold mb-4">Localizar e Substituir</h2>
            <div class="space-y-4">
                <input type="text" id="find-input" placeholder="Localizar..." class="w-full p-2 border rounded-md bg-white dark:bg-slate-700 dark:border-slate-600">
                <input type="text" id="replace-input" placeholder="Substituir por..." class="w-full p-2 border rounded-md bg-white dark:bg-slate-700 dark:border-slate-600">
                <div class="flex justify-end gap-2">
                    <button id="replace-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Substituir</button>
                    <button id="replace-all-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Substituir Tudo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Caixa de Mensagem (Toast) -->
    <div id="message-box" role="alert" aria-live="polite"></div>
    
    <!-- Scripts do Editor 100% Offline com IndexedDB -->
    <script src="script.js"></script>
</body>
</html>
